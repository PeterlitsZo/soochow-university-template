\section{欧拉筛}
\label{sec:欧拉筛}


埃氏筛和埃氏筛的扩展区间筛，见章节 \ref{sec:埃氏筛}。

欧拉筛可以在 $O(n)$ 的时间复杂度内判定 $1 \sim n$ 的素数情况，故又叫做线性筛。下
面的代码，将素数数组的长度存储在 \cmd{P[0]} 中，因为是数组，所以会快一些：
\begin{Cpp}
const int PRAG=/* PRM 这个素数表的最大范围 */;
int PRM[PRAG/* 因为素数分布定理，PRAG 等于 10^P 的时候，右移 log_2 P 位即可*/];
bitset<PRAG> notP;

// 求最小质因子的表。
// int SMFA[PRAG]; /* 可选 */

void init() {
  notP[0]=notP[1]=true;
  for(int i=2;i<PRAG;i++){
    if(!notP[i]){
      PRM[++PRM[0]]=i;
      // SMFA[i]=i;/* 可选 */
    }
    for(int pi=1;PRM[pi]*i<PRAG;pi++){
      notP[PRM[pi]*i]=true;
      // SMFA[PRM[pi]*i]=PRM[pi];/* 可选 */
      if(i%PRM[pi]==0)break;
    }
  }

  // etc...
}
\end{Cpp}

想要使用线性筛求欧拉函数？见章节 \ref{subsec:线性筛求欧拉函数}。
